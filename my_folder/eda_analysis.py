import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„
df = pd.read_excel("/content/Sentiment Analysis data (2) (1).xlsx")

# Ø­Ø°Ù Ø±Ø¯ÛŒÙ Ø§ÙˆÙ„ Ú©Ù‡ Ø¯Ø± ÙˆØ§Ù‚Ø¹ Ø¹Ù†ÙˆØ§Ù† Ø³ØªÙˆÙ†â€ŒÙ‡Ø§Ø³Øª
df = df.iloc[1:].copy()

# Ù†Ø§Ù…Ú¯Ø°Ø§Ø±ÛŒ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§
df.columns = ['comment', 'label']

# ØªØ¨Ø¯ÛŒÙ„ Ù†ÙˆØ¹ Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§ Ø¨Ù‡ Ø¹Ø¯Ø¯ ØµØ­ÛŒØ­
df['label'] = df['label'].astype(int)

# ØªØ¨Ø¯ÛŒÙ„ Ø³ØªÙˆÙ† Ú©Ø§Ù…Ù†Øª Ø¨Ù‡ Ø±Ø´ØªÙ‡ (Ø¯Ø± ØµÙˆØ±Øª ÙˆØ¬ÙˆØ¯ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø¹Ø¯Ø¯ÛŒ)
df['comment'] = df['comment'].astype(str)

# Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø·ÙˆÙ„ Ù…ØªÙ†â€ŒÙ‡Ø§
df['char_length'] = df['comment'].apply(len)
df['word_count'] = df['comment'].apply(lambda x: len(x.split()))

# ---------------------------
# ğŸ” Ø¨Ø±Ø±Ø³ÛŒ Ø¢Ù…Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
# ---------------------------
print("âœ… ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ù†Ù…ÙˆÙ†Ù‡â€ŒÙ‡Ø§:", len(df))
print("\nâœ… ØªØ¹Ø¯Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡ Ø¯Ø± Ù‡Ø± Ú©Ù„Ø§Ø³:")
print(df['label'].value_counts())

print("\nâœ… ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ:", df.duplicated().sum())
print("âœ… ØªØ¹Ø¯Ø§Ø¯ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø®Ø§Ù„ÛŒ Ø¯Ø± Ù‡Ø± Ø³ØªÙˆÙ†:\n", df.isnull().sum())

# ---------------------------
# ğŸ“Š Ø±Ø³Ù… Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
# ---------------------------
plt.figure(figsize=(15, 4))

# Ù†Ù…ÙˆØ¯Ø§Ø± ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§
plt.subplot(1, 3, 1)
sns.countplot(x='label', data=df)
plt.title('ØªØ¹Ø¯Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡ Ø¯Ø± Ù‡Ø± Ø¨Ø±Ú†Ø³Ø¨')
plt.xlabel('Ø¨Ø±Ú†Ø³Ø¨ (1=Ù…Ø«Ø¨Øª, 0=Ø®Ù†Ø«ÛŒ, -1=Ù…Ù†ÙÛŒ)')

# Ù†Ù…ÙˆØ¯Ø§Ø± ØªÙˆØ²ÛŒØ¹ Ø·ÙˆÙ„ Ú©Ø§Ø±Ø§Ú©ØªØ±ÛŒ Ù†Ø¸Ø±Ø§Øª
plt.subplot(1, 3, 2)
sns.histplot(df['char_length'], bins=50, kde=True, color='skyblue')
plt.title('ØªÙˆØ²ÛŒØ¹ Ø·ÙˆÙ„ Ù†Ø¸Ø±Ø§Øª (Ú©Ø§Ø±Ø§Ú©ØªØ±)')

# Ù†Ù…ÙˆØ¯Ø§Ø± ØªÙˆØ²ÛŒØ¹ ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª
plt.subplot(1, 3, 3)
sns.histplot(df['word_count'], bins=50, kde=True, color='orange')
plt.title('ØªÙˆØ²ÛŒØ¹ ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª Ø¯Ø± Ù†Ø¸Ø±Ø§Øª')

plt.tight_layout()
plt.show()

# ---------------------------
# ğŸ“ Ù†Ù…Ø§ÛŒØ´ Ú†Ù†Ø¯ Ù†Ù…ÙˆÙ†Ù‡ ØªØµØ§Ø¯ÙÛŒ
# ---------------------------
print("\nğŸ” Ú†Ù†Ø¯ Ù†Ù…ÙˆÙ†Ù‡ ØªØµØ§Ø¯ÙÛŒ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:")
print(df.sample(5))
